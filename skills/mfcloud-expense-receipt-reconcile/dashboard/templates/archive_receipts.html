<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿é ˜åæ›¸ä¸€è¦§ {{ ym }}</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <div
      class="page"
      data-active-tab="{{ active_tab | default('status', true) }}"
      data-sidebar-links='{{ (sidebar_links | default([], true)) | tojson }}'
    >
      <header class="hero">
        <div>
          <p class="eyebrow">çµŒè²»ç²¾ç®—ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</p>
          <h1>{{ ym }} ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿é ˜åæ›¸ä¸€è¦§</h1>
          <p class="subtitle">Step5ã§ä½œæˆã—ãŸã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å†…ã®PDFã‚’ä¸–ä»£ã”ã¨ã«ç¢ºèªã§ãã¾ã™ã€‚</p>
      </header>

      <section class="card">
        <h2>æ¦‚è¦</h2>
        <div class="form-row">
          <span class="muted">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¸–ä»£ {{ snapshot_count }} ä»¶</span>
          <span class="muted">PDFåˆè¨ˆ {{ total }} ä»¶</span>
          <span class="muted">Amazon {{ amazon_count }} ä»¶</span>
          <span class="muted">æ¥½å¤© {{ rakuten_count }} ä»¶</span>
        </div>
        <div class="form-row">
          <label>
            æœˆ
            <select id="filter-month" data-current-ym="{{ ym }}">
              {% for month_ym in available_months %}
              <option value="{{ month_ym }}" {% if month_ym == ym %}selected{% endif %}>{{ month_ym }}</option>
              {% endfor %}
            </select>
          </label>
          <label>
            æ¤œç´¢
            <input type="text" id="archive-search" placeholder="ä¸–ä»£ / ç¨®åˆ¥ / PDFå ã§æ¤œç´¢" />
          </label>
          <span class="muted">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¿å­˜å…ˆ: {{ archive_root or "-" }}</span>
          <span class="muted">è¡¨ç¤ºä¸­ <span id="archive-count">{{ total }}</span> ä»¶</span>
        </div>
      </section>

      <section class="card">
        <h2>ä¸–ä»£ä¸€è¦§</h2>
        {% if snapshots %}
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¸–ä»£</th>
                <th>Amazon</th>
                <th>æ¥½å¤©</th>
                <th>åˆè¨ˆ</th>
              </tr>
            </thead>
            <tbody>
              {% for snap in snapshots %}
              <tr>
                <td>{{ snap.snapshot_label }}</td>
                <td>{{ snap.amazon_count }}</td>
                <td>{{ snap.rakuten_count }}</td>
                <td>{{ snap.receipt_count }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <p class="muted">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        {% endif %}
      </section>

      <section class="card">
        <h2>é ˜åæ›¸PDFä¸€è¦§</h2>
        {% if rows %}
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¸–ä»£</th>
                <th>ç¨®åˆ¥</th>
                <th>PDF</th>
                <th>ã‚µã‚¤ã‚º</th>
                <th>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</th>
              </tr>
            </thead>
            <tbody id="archive-table-body">
              {% for row in rows %}
              <tr
                class="archive-row"
                data-search="{{ row.snapshot_label }} {{ row.source_label }} {{ row.pdf_name }}"
              >
                <td>{{ row.snapshot_label }}</td>
                <td>{{ row.source_label }}</td>
                <td>{{ row.pdf_name }}</td>
                <td>{{ row.pdf_size_kb }} KB</td>
                <td>
                  <a
                    href="/files/{{ ym }}/archive/{{ row.snapshot }}/{{ row.source }}/{{ row.pdf_name }}"
                    target="_blank"
                    rel="noopener"
                  >
                    ğŸ“„ é–‹ã
                  </a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <p class="muted">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿PDFã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        {% endif %}
      </section>
    </div>

    <script src="/static/js/common.js"></script>
    <script src="/static/js/archive-receipts.js"></script>
  </body>
</html>
