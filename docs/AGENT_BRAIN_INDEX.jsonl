{"commit": "792a848adfbc0f5e9b27eabb9a7486bbefa90e7f", "timestamp": "2026-02-18T06:28:27+09:00", "summary": "Configurable Gemini model and API key via environment variables in commit analysis script.", "intent": "Allow users to switch Gemini models and provide API keys through standardized environment variables (KIL_GEMINI_MODEL, KIL_GEMINI_API_KEY) instead of hardcoded values.", "new_rules": ["Use the environment variable 'KIL_GEMINI_MODEL' to override the default LLM model in KIL scripts.", "Support 'KIL_GEMINI_API_KEY' as a valid environment variable for Gemini authentication.", "Default the Gemini model to 'gemini-flash-latest' for commit analysis tasks."], "anti_patterns": ["Hardcoding specific LLM model versions (e.g., 'gemini-1.5-flash') in operational scripts, preventing easy upgrades or testing."], "debt": [], "scope": ["scripts/analyze_commit.py", "KIL configuration"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "dfbd198814375dc68484f54d4777dc7c93d0c080", "timestamp": "2026-02-18T07:16:27+09:00", "summary": "pre-commit実行時にpost-commitフックの設置状態を強制チェックするガード機能の導入", "intent": "KILの運用に不可欠なpost-commitフックが未設置または非管理状態のままコミットされるのを防ぎ、自動化された知識循環を保証するため。", "new_rules": ["pre-commitフックにおいて、post-commitフックが存在し、かつ 'KIL_MANAGED_HOOK: post-commit' という識別子が含まれているかを検証しなければならない。", "フックの検証に失敗した場合は、コミットを中断し 'scripts/bootstrap_kil.ps1' の実行をユーザーに促すこと。", "Gitの core.hooksPath 設定を考慮し、絶対パスおよびリポジトリルートからの相対パスの両方でフックディレクトリを特定するロジックを維持すること。"], "anti_patterns": ["KIL管理外のpost-commitフックを手動で設置し、自動化プロセスをバイパスすること。", "PowerShellスクリプトで外部コマンドの出力をキャプチャする際、ErrorActionPreferenceを適切に制御せずに実行結果を判定すること。"], "debt": ["Husky経由のBashスクリプトでGit設定をパースしているが、Windows/Linux間のパス区切り文字の差異に関する厳密なテストが不足している可能性がある。", "bootstrap_kil.ps1 におけるエラー出力の配列化処理が、特定のPowerShellバージョンに依存する挙動を含んでいる可能性がある。"], "scope": [".husky/_/pre-commit", "scripts/bootstrap_kil.ps1", "Git Hooks configuration"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "b28a03656cf5d562b8f9172c69a3680bca942951", "timestamp": "2026-02-18T07:29:22+09:00", "summary": "KILレビュー専用ダッシュボードの導入と、リスクフィルタリング・ヘルスチェック機能の実装", "intent": "KILの解析状態（遅延や精度）を可視化し、人間によるレビューの効率化とリスクベースの意思決定を支援する。", "new_rules": ["KILの運用健全性を「コミット遅延数」「解析経過日数」「Markdown比率」の3指標で評価・監視する。", "レビュー専用のデータソースとして `docs/AGENT_BRAIN_REVIEW.jsonl` を、軽量な運用指針として `docs/KIL_MINI_RULES.md` を維持・活用する。", "リスク分布に基づいたフィルタリング機能を活用し、高リスクな変更を優先的にレビュー対象とする。"], "anti_patterns": ["解析の遅延（Lag）が発生している状態で、古い知識に基づいた自動判断を無批判に受け入れること。", "PowerShell環境において、Husky等のツールを経由してBash依存のスクリプトや構文をフックに混入させること。"], "debt": ["Husky経由のBashスクリプトとPowerShell環境（bootstrap_kil.ps1）の完全な互換性確保と自動検知ロジックの洗練。", "AGENT_BRAIN_INDEX.jsonl と AGENT_BRAIN_REVIEW.jsonl の間のデータ整合性維持メカニズム。"], "scope": ["KIL運用管理", "ダッシュボード", "リスク管理", "Git Hook"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "7d40b87e3b5ea31995e8fafbb46fa6200b157370", "timestamp": "2026-02-18T07:29:58+09:00", "summary": "post-commit hookの実行ログをGit管理対象外に設定", "intent": "KILのpost-commit hookが生成するランタイムログ（docs/.kil_post_commit_hook.log）がリポジトリに混入するのを防ぎ、クリーンなコミット履歴を維持する。", "new_rules": ["Git hookの実行によって生成される一時的なログファイルは、原則として .gitignore に追加し、リポジトリにコミットしない。"], "anti_patterns": ["自動生成される実行ログ（.logファイル）をGitの追跡対象に含めること。"], "debt": ["ログファイルが docs/ 配下に生成されているが、プロジェクトの標準的なログ出力先（logs/等）に集約すべきか検討の余地がある。"], "scope": [".gitignore", "Git Hooks", "KIL Runtime"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "b44c45fce3487cd1decf5c306a17c90e6c4a304a", "timestamp": "2026-02-18T07:30:32+09:00", "summary": "chore: sync KIL knowledge records after dashboard update", "intent": "コミット本文に意図が記載されていません。", "new_rules": ["コミット差分の影響範囲を限定してレビューし、不要な範囲の仮説を避ける。"], "anti_patterns": [], "debt": ["現時点で確度が高い未解決課題は確認できませんでした。"], "scope": ["docs"], "confidence": 0.35, "risk": "medium", "review_deadline": null, "source": "fallback"}
{"commit": "930fb5a4c6ddea460262f93c8c0f704122f74868", "timestamp": "2026-02-18T07:33:58+09:00", "summary": "Geminiからのレスポンス解析におけるJSON抽出ロジックの堅牢化", "intent": "LLMがJSON以外の説明文やMarkdown装飾（お喋り）を返した場合でも、必要なJSONデータを正確に抽出して解析失敗を防ぐため。", "new_rules": ["LLMのレスポンス解析には、Markdownコードブロックの抽出と、中括弧のネスト深さを追跡するロジックを組み合わせて使用する。", "解析失敗時のエラーメッセージには、原因特定を容易にするためレスポンスのプレビュー（最大1200文字程度）を含める。", "実行時のエラーログ（docs/AGENT_BRAIN_ERROR.log）はGit管理対象外とする。"], "anti_patterns": ["LLMが純粋なJSONのみを返すと盲信し、単純な正規表現のみでパースを試みること。", "解析エラー時にレスポンス内容を破棄し、デバッグ情報を残さないこと。"], "debt": ["中括弧のカウントによるJSON抽出ロジックにおいて、極めて複雑なエスケープ文字を含む文字列リテラルに対する完全な堅牢性の検証。", "maxOutputTokensの倍増（1536→3072）に伴う、APIコストおよびレスポンス遅延への影響評価。"], "scope": ["scripts/analyze_commit.py", ".gitignore", "KIL Runtime"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "131847d75c9c39cb24532e31a0c46272075dbcc1", "timestamp": "2026-02-18T07:34:25+09:00", "summary": "LLMレスポンス（特にGemini）のJSONパース処理における堅牢性の向上とエラー情報の詳細化", "intent": "LLMが不正な形式や余計な装飾を含むJSONを返した場合の耐障害性を高め、パース失敗時のデバッグ効率を改善する。", "new_rules": ["LLMの出力パースには直接 json.loads を使用せず、マークダウン等のノイズを除去可能な抽出ロジック（_parse_json_from_model_text等）を介在させる。", "パース失敗時のエラーメッセージには、原因調査を容易にするため、定数（LLM_RESPONSE_TEXT_PREVIEW）で制限したレスポンスのプレビューを含める。"], "anti_patterns": ["LLMの出力を単純な strip() だけで json.loads に渡すこと（Gemini等のペイロード形式の変化に対応できないため）。", "パース失敗時に、受信した生データの内容を一切出力しないこと。"], "debt": ["_parse_json_from_model_text の内部実装（正規表現等）がカバーしきれない特殊なフォーマットが存在する可能性。"], "scope": ["scripts/analyze_commit.py", "LLMレスポンス解析ロジック"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "9f3ff0ee1c6e9c037bdfc65e21d44c7c51615949", "timestamp": "2026-02-18T07:34:35+09:00", "summary": "Geminiからのレスポンス解析におけるJSON抽出ロジックの堅牢化", "intent": "LLMがJSON以外の説明文やMarkdown装飾を含めて回答した場合でも、必要なデータを正確に抽出して解析失敗を防ぐため。", "new_rules": ["LLMのレスポンス解析には、Markdownコードブロックの抽出と、中括弧のネスト深さを追跡するロジックを組み合わせて使用する。", "解析失敗時のエラーメッセージには、原因特定を容易にするためレスポンスのプレビュー（最大1200文字程度）を含める。", "実行時のエラーログ（docs/AGENT_BRAIN_ERROR.log）はGit管理対象外とする。"], "anti_patterns": ["LLMが純粋なJSONのみを返すと盲信し、単純な正規表現のみでパースを試みること。", "解析エラー時にレスポンス内容を破棄し、デバッグ情報を残さないこと。"], "debt": ["中括弧のカウントによるJSON抽出ロジックにおいて、極めて複雑なエスケープ文字を含む文字列リテラルに対する完全な堅牢性の検証。", "maxOutputTokensの倍増（1536→3072）に伴う、APIコストおよびレスポンス遅延への影響評価。"], "scope": ["scripts/analyze_commit.py", ".gitignore", "KIL Runtime"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "1062c93c8388dbb1e9d8d8d0e81a70540d7fe038", "timestamp": "2026-02-18T07:34:44+09:00", "summary": "LLMレスポンス解析（JSONパース）の堅牢化に関する運用知識の記録", "intent": "LLM（特にGemini）が生成するMarkdown装飾やノイズを含むレスポンスから、正確にJSONを抽出し、解析失敗時のデバッグ効率を向上させるための設計方針を知識ベースに定着させる。", "new_rules": ["LLMの出力パースには直接 json.loads を使用せず、Markdownコードブロックの抽出と中括弧のネスト深さ追跡を組み合わせた専用ロジック（_parse_json_from_model_text等）を介在させる。", "パース失敗時のエラーメッセージには、原因特定を容易にするため、定数で制限されたレスポンスのプレビュー（最大1200文字程度）を含める。", "実行時のエラーログ（docs/AGENT_BRAIN_ERROR.log）はGit管理対象外（.gitignore）とする。"], "anti_patterns": ["LLMが純粋なJSONのみを返すと盲信し、単純な strip() や正規表現のみでパースを試みること。", "解析エラー時に受信した生データを破棄し、デバッグ情報をログに残さないこと。"], "debt": ["中括弧のカウントによるJSON抽出ロジックにおいて、極めて複雑なエスケープ文字を含む文字列リテラルに対する完全な堅牢性の検証。", "maxOutputTokensの倍増（1536→3072）に伴う、APIコストおよびレスポンス遅延への影響評価。"], "scope": ["scripts/analyze_commit.py", "docs/AGENT_BRAIN.md", "LLMレスポンス解析ロジック"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "50c5569352794e9f0a19ac45c1c9ea5ceb627cc2", "timestamp": "2026-02-18T07:35:09+09:00", "summary": "Gemini APIにおける構造化JSON出力の要求と失敗時のフォールバック機構の導入", "intent": "LLMからのレスポンスを最初からJSON形式に固定することでパースの信頼性を高めつつ、API側の制約やエラーによる停止を防ぐため。", "new_rules": ["Gemini APIへのリクエスト時、まずは generationConfig に responseMimeType: application/json を設定して構造化出力を試みる。", "構造化出力のリクエストが失敗（RuntimeError等）した場合は、従来のプレーンなリクエスト設定で再試行するフォールバック処理を実装する。"], "anti_patterns": ["APIの構造化出力機能に過度に依存し、エラー時の代替手段を用意しないこと。", "リクエスト失敗時に原因を切り分けず、一律に処理を中断すること。"], "debt": ["フォールバックが発生した際のログ出力が不十分であり、運用中にどちらのモードが適用されたか追跡が困難。", "RuntimeError のキャッチ範囲が広く、リトライすべき一時的エラーと設定エラーの区別がなされていない。"], "scope": ["scripts/analyze_commit.py", "Gemini API integration"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "b5a34d9551a6f6b4699e27e0d3659f6b1722e21d", "timestamp": "2026-02-18T07:35:37+09:00", "summary": "Gemini APIにおける構造化JSON出力の要求と失敗時のフォールバック機構の導入", "intent": "LLMからのレスポンスを最初からJSON形式に固定することでパースの信頼性を高めつつ、API側の制約やエラーによる処理停止を防ぐため。", "new_rules": ["Gemini APIへのリクエスト時、まずは generationConfig に responseMimeType: application/json を設定して構造化出力を試みる。", "構造化出力のリクエストが失敗（RuntimeError等）した場合は、従来のプレーンなリクエスト設定で再試行するフォールバック処理を実装する。"], "anti_patterns": ["APIの構造化出力機能に過度に依存し、エラー時の代替手段を用意しないこと。", "リクエスト失敗時に原因を切り分けず、一律に処理を中断すること。"], "debt": ["フォールバックが発生した際のログ出力が不十分であり、運用中にどちらのモードが適用されたか追跡が困難。", "RuntimeError のキャッチ範囲が広く、リトライすべき一時的エラーと設定エラーの区別がなされていない。"], "scope": ["scripts/analyze_commit.py", "Gemini API integration"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "d49716a556d6da98126f63b67fc6ecd7ee5552f0", "timestamp": "2026-02-18T07:41:19+09:00", "summary": "KILドキュメント（AGENT_BRAIN）のパス解決ロジックの動的化と診断情報の可視化", "intent": "実行環境ごとに異なるドキュメント配置場所を自動特定し、パス解決失敗時のデバッグ効率を向上させるため、複数の候補パスを順次探索する仕組みを導入する。", "new_rules": ["KILドキュメントの探索は、スキルルートからカレントディレクトリまで5段階の優先順位（skill_root/docs, skills/docs, repo_root/docs, repo_parent/docs, cwd/docs）で行う。", "AGENT_BRAIN_INDEX.jsonl または AGENT_BRAIN.md が存在するディレクトリを優先的に選択する。", "APIレスポンスに診断情報（diagnostics）を含め、フロントエンドで探索状況（存在有無、選択理由）を表示可能にする。"], "anti_patterns": ["特定の相対パス（例: ../../docs）のみを固定で参照し、環境差異（開発環境 vs デプロイ環境）を考慮しない実装を避ける。"], "debt": ["探索候補パスが api.py 内にハードコードされており、リポジトリ構成の根本的な変更時にはこのリストの更新が必要。", "requested_source パラメータにおいて 'fallback' が指定された場合に 'all' へ内部変換されるなど、一部のパラメータ解釈が暗黙的である。"], "scope": ["KIL (Knowledge Integration Loop) レビュー機能", "ドキュメントパス解決ロジック（api.py）", "レビュー画面UI（kil-review.js）"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "67290714ea53a8cdb6d4c81bb3b810c639f39726", "timestamp": "2026-02-18T07:45:26+09:00", "summary": "KILレビューメタデータの同期とダッシュボードAPI接続の堅牢化（フォールバック実装）", "intent": "実行環境（ローカル、コンテナ、デプロイ先）によるポートやホストの差異を吸収し、フロントエンドからのAPI接続成功率を向上させるとともに、過去の獲得知識をドキュメントに反映するため。", "new_rules": ["フロントエンドからのAPI呼び出しには、現在のOriginに加え、localhost/127.0.0.1および特定のフォールバックポート（8765, 8000）を候補として順次試行するロジックを実装する。", "API接続失敗時のエラーメッセージには、試行したURLと具体的なエラー原因（HTTPステータスや例外メッセージ）を含め、デバッグを容易にする。", "KILドキュメント（AGENT_BRAIN.md）の更新時は、INDEX.jsonlおよびREVIEW.jsonlのメタデータも同期させる。"], "anti_patterns": ["APIエンドポイントを単一の相対パスや特定のホスト・ポートに固定し、環境差異による接続失敗を許容すること。", "APIリクエスト失敗時に、どのエンドポイントでどのようなエラーが発生したかの詳細を破棄すること。"], "debt": ["フォールバック対象のポート番号（8765, 8000）がJavaScript内にハードコードされており、インフラ構成の変更時に手動更新が必要。", "複数のエンドポイントを順次試行するため、ネットワークタイムアウトの設定がない場合、最終的なエラー表示までに時間がかかる可能性がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/kil-review.js", "docs/AGENT_BRAIN.md", "KIL Dashboard API integration"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "67c769581d4fbaee5f7869609da632dfb931a9c2", "timestamp": "2026-02-19T06:15:35+09:00", "summary": "KIL計画書およびスケジューラスクリプトのUTF-8正規化と、KIL自律学習ループの運用ルールの明文化。", "intent": "ドキュメントの文字化けを解消し、コミットごとの知識抽出（AGENT_BRAINへの反映）とタスク開始前の文脈確認を標準プロセスとして定義する。", "new_rules": ["post-commitフックによりscripts/analyze_commit.pyを自動実行し、最新の知識をAGENT_BRAINに反映する。", "タスク開始前にAGENT_BRAIN.mdおよびAGENT_BRAIN_INDEX.jsonlの最新5件以上を確認し、制約や未解決事項を引き継ぐ。", "GEMINI_API_KEY等の機密情報はリポジトリ外の環境変数ファイル（~/.ax/secrets/kintone.env等）で管理する。", "AGENT_BRAINの更新が止まっていないか、エントリ数の推移を定期的に確認する。"], "anti_patterns": ["APIキーやモデル名などの機密情報をリポジトリ内のファイルに直接記述する。", "AGENT_BRAINの反映失敗を理由にコミットをブロックする（エラーログを記録し、次回タスク開始時に復旧させる）。", "過去のAGENT_BRAINの履歴を確認せずに新規タスクの判断を行う。"], "debt": ["反映処理失敗時の復旧対応が運用ルール（手動/次回開始時）に依存しており、自動リトライ等の仕組みは未定義。", "UTF-8正規化が他の既存スクリプトにも必要かどうかの全量調査。"], "scope": ["docs/KIL_PLAN.md", "scripts/analyze_commit.py", "AGENT_BRAIN 運用フロー", "環境変数・秘匿情報管理"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "5b32cadfe24a1b629baa69ab27360f4d1a74d728", "timestamp": "2026-02-19T07:30:23+09:00", "summary": "ワークフローテンプレートのUX改善およびアーカイブ済みワークフロー管理画面の分離", "intent": "メイン画面の煩雑さを解消するため、アーカイブ済みワークフローを専用ページに分離し、ワークフローデータの正規化処理をAPI層に追加してフロントエンドでの一貫性を確保する。", "new_rules": ["ワークフローのステップ情報やノート情報は、APIレスポンス返却前に `_normalize_workflow_template_steps` 等の正規化関数を必ず通すこと。", "アーカイブ済みワークフローの管理ロジックは `workflow-archive-pages.js` に集約し、メインのダッシュボードロジックから分離すること。", "サイドバーのリンク情報は HTML の `data-sidebar-links` 属性を介して JSON 形式でフロントエンドに渡す設計を維持する。"], "anti_patterns": ["アクティブなワークフローとアーカイブ済みワークフローの表示・操作ロジックを同一の JS ファイルやテンプレートに混在させること。", "API レスポンスにおいて、正規化されていない生の DB 行データをそのままフロントエンドに返却すること。"], "debt": ["正規化ロジック（_normalize_workflow_template_steps 等）が複数の API エンドポイントで重複定義されている可能性があるため、共通ユーティリティへの集約が必要か確認が必要。", "フロントエンドのトースト通知や共通処理が `common.js` に依存しているが、ページ分割に伴い依存関係の整理が必要になる可能性がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "004e2c56e3df3e5fc6f6695a952d3eb78abeda3b", "timestamp": "2026-02-19T07:47:26+09:00", "summary": "ワークフロー作成画面の簡素化と年月処理の自動補完ロジックの導入", "intent": "ユーザーの入力負荷を軽減し、年月のバリデーションエラーを防ぐため、現在日時をベースとした自動補完（resolveFormYearMonth）を導入し、UIを整理する。", "new_rules": ["年月の入力値は `resolveFormYearMonth` を通じて取得し、未入力や不正値（2000年未満、1-12月以外）の場合は現在の年月をデフォルトとして適用する。", "UI上の「小見出し」という表記は「補足説明」に統一する。", "ワークフロー作成時の確認ダイアログには、ユーザーが直接変更できない内部的な詳細情報（ソースURL件数など）を含めず、簡潔な内容にする。"], "anti_patterns": ["フロントエンドのイベントハンドラ内で個別に年月の必須チェックバリデーションを実装すること（リゾルバによる自動補完に任せる）。", "ワークフロー作成のメインフローにおいて、頻繁に変更しない高度な設定（複数URLの追加等）を露出させ、UIを複雑化させること。"], "debt": ["サーバーサイド（Python）でのデフォルト値設定と、フロントエンド（JS）での `resolveFormYearMonth` によるデフォルト値決定ロジックが二重管理になっている可能性がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/index.js", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/expense_workflow_copy.html"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "b311521df2b7e94d78eef2d04cfaf3126991038e", "timestamp": "2026-02-19T08:28:47+09:00", "summary": "管理センター（Error Center）へのWFアーカイブ管理およびKIL Review機能の統合と、ワークフロー設定制約の導入", "intent": "管理機能を一箇所に集約し、タブ切り替えによる操作性を向上させるとともに、ワークフローテンプレートの構成要素（必須ステップやタイマー制限）を標準化する。", "new_rules": ["ワークフローテンプレートには 'preflight' と 'mf_reconcile' のステップを必須とする。", "ワークフローのステップタイマーはデフォルト5分、最大10,080分（1週間）の範囲で設定する。", "WFアーカイブおよびKIL Reviewへのアクセスは、独立したパスではなく '/errors?tab=workflow-archive' および '/errors?tab=kil-review' を使用する。", "ワークフローの各ステップには、定義された標準タイトル（WORKFLOW_TEMPLATE_REQUIRED_STEP_TITLES）を適用する。"], "anti_patterns": ["管理センター外に独立した管理用ページを新設すること。", "1週間（10,080分）を超えるワークフロータイマーの設定。", "必須ステップ（preflight, mf_reconcile）を欠いたワークフローテンプレートの定義。"], "debt": ["旧パス（/workflow-pages/archived, /kil-review）からのリダイレクト処理が残存しているため、フロントエンドのリンクを直接タブ指定形式に完全移行した後に削除を検討する必要がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/pages.py", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/", "ワークフローテンプレート定義"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "b8ec49d7c8b5cd579defec61d942f88f7e6ce90f", "timestamp": "2026-02-19T08:31:00+09:00", "summary": "ワークスペースの定義を「エージェントの作業場」から「人間による自動化準備・管理ハブ」へ変更し、運用管理用のメタデータ項目を追加しました。", "intent": "自動化プロセスの属人化を防ぎ、人間がエージェントに指示を出す前の準備（リンク管理、プロンプト整備、担当者割り当て）を徹底させるためのガバナンス強化。", "new_rules": ["ワークスペース（Automation Hub）は、エージェントが直接操作する場所ではなく、人間が自動化運用を準備・管理する画面として定義する。", "各自動化リンクには「担当者」「推奨エージェント」「最終見直し日」のメタデータを付与し、運用の透明性と鮮度を維持する。", "エージェントへの指示出しは、URL・目的・プロンプトをパッケージ化した「実行指示セット」をコピーして利用する運用を推奨する。"], "anti_patterns": ["エージェントが直接この管理画面を操作することを前提とした設計やプロンプトの作成。", "担当者や見直し日を更新せず、プロンプトやリンクの有効性を放置すること。"], "debt": ["推奨エージェントの選択肢（Codex, ChatGPT, Claude, Gemini等）がHTMLにハードコードされており、新しいモデルへの対応にコード修正が必要。", "削除された「ステータスページ」へのリンクの代替確認手段が定義されていない。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/templates/workspace.html", "skills/mfcloud-expense-receipt-reconcile/tests/test_dashboard_pages.py"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "d7581456e185355a7eee7d77d3e91aa5224c7721", "timestamp": "2026-02-19T08:32:07+09:00", "summary": "ダッシュボードにおけるワークフロー管理機能の改善（タイマー設定の追加、正規化処理の徹底、アーカイブ管理の分離）", "intent": "ワークフローテンプレートのUX向上と、コードの保守性向上のためのロジック分離およびデータ正規化の強制。", "new_rules": ["ワークフローのステップ情報（タイトル、アクション、タイマー等）は、API返却前に必ず _normalize_workflow_template_steps 等の正規化関数を通すこと。", "サイドバーのリンク情報は HTML の data-sidebar-links 属性を介した JSON 形式での受け渡しを維持する。", "ワークフローのステップタイマー設定（timer_minutes）を適切に処理・保存し、テストコードで検証すること。"], "anti_patterns": ["アクティブなワークフローとアーカイブ済みワークフローの表示・操作ロジックを同一の JS ファイルやテンプレートに混在させること。", "API レスポンスにおいて、正規化されていない生の DB 行データをそのままフロントエンドに返却すること。"], "debt": ["正規化ロジック（_normalize_workflow_template_steps 等）が複数の API エンドポイントで重複定義されている可能性があるため、共通ユーティリティへの集約が必要。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "c40c2d71d91e251828b539124a1d6d9d249085cf", "timestamp": "2026-02-19T08:32:32+09:00", "summary": "ダッシュボードにおけるワークフロー管理機能の改善（タイマー設定の追加、正規化処理の徹底、アーカイブ管理の分離）", "intent": "ワークフローテンプレートのUX向上と、コードの保守性向上のためのロジック分離およびデータ正規化の強制。", "new_rules": ["ワークフローのステップ情報（タイトル、アクション、タイマー等）は、API返却前に必ず _normalize_workflow_template_steps 等の正規化関数を通すこと。", "サイドバーのリンク情報は HTML の data-sidebar-links 属性を介した JSON 形式での受け渡しを維持する。", "ワークフローのステップタイマー設定（timer_minutes）を適切に処理・保存し、テストコードで検証すること。"], "anti_patterns": ["アクティブなワークフローとアーカイブ済みワークフローの表示・操作ロジックを同一の JS ファイルやテンプレートに混在させること。", "API レスポンスにおいて、正規化されていない生の DB 行データをそのままフロントエンドに返却すること。"], "debt": ["正規化ロジック（_normalize_workflow_template_steps 等）が複数の API エンドポイントで重複定義されている可能性があるため、共通ユーティリティへの集約が必要。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "b10b43fc01d02b897d795b7ef12cbdc73ae4aae2", "timestamp": "2026-02-19T09:11:58+09:00", "summary": "ドキュメントの鮮度確認（freshness check）をKIL依存のターゲットから、環境変数で指定されたディレクトリ配下のファイルベースのチェックに移行しました。", "intent": "KILフレームワークへの依存を排除し、汎用的なファイル更新日時ベースの監視を可能にすること。また、APIにリミット機能を導入し、UIでの表示制御とパフォーマンスを改善することを目的としています。", "new_rules": ["ドキュメント監視対象のルートディレクトリは環境変数 `AX_DOC_FRESHNESS_ROOTS` で定義する。", "ドキュメント鮮度確認API（/api/errors/document-freshness）は `limit` クエリパラメータによる取得件数の制限をサポートしなければならない。", "フロントエンドの表示ロジックは、サマリー情報（total, displayed, hidden）に基づいて、表示制限がかかっている状態をユーザーに通知する設計にする。"], "anti_patterns": ["監視対象のドキュメントパスをソースコード内にハードコードすること。", "大量のドキュメントが存在する環境で、リミットを設けずに全件のメタデータを一度に取得・表示しようとすること。"], "debt": ["既存のKILターゲットベースのロジックが他のコンポーネントに残存していないかの確認が必要。", "正規表現によるファイル抽出ロジックが複雑なディレクトリ構造において意図通り動作するかの検証。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/api_runs.py", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/errors.js", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/errors.html"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "a0bc595144db6e8c63722fd44e058fcc28291a82", "timestamp": "2026-02-19T09:31:06+09:00", "summary": "ワークフローテンプレートMVP実装に向けたダッシュボード機能の更新と、ワークスペースリンク昇格前のチェックポイント。", "intent": "ワークフローのコピー・編集ロジックの整合性を確保し、正規化処理を徹底することで、フロントエンドとバックエンド間のデータ不整合を防ぐ。また、開発ドキュメントを更新し、次フェーズへの準備を整える。", "new_rules": ["ワークフローのステップ情報は、API返却前に必ず正規化関数（_normalize_workflow_template_steps等）を介在させること。", "サイドバーのリンク情報は、HTMLのdata-sidebar-links属性を用いたJSON形式での受け渡しを維持すること。", "ワークフローのコピー・編集画面において、template_idとtemplate_modeの初期値設定を厳密に管理し、テストで検証すること。"], "anti_patterns": ["APIレスポンスにおいて、正規化されていない生のDBデータを直接フロントエンドに返却すること。", "アクティブなワークフローとアーカイブ済みワークフローの操作ロジックを、分離せずに同一のJS/テンプレートに混在させること。"], "debt": ["正規化ロジックが複数のAPIエンドポイントに分散しており、共通化の余地がある。", "ワークスペースリンクの昇格（promotion）に伴う大規模な構造変更が予定されており、既存のリンク生成ロジックへの影響が懸念される。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/", "docs/workflow_template_mvp_*"], "confidence": 0.9, "risk": "medium", "review_deadline": "2026-03-05", "source": "llm"}
{"commit": "8ebddc703ab6d6fb3dda42f018b72135ab101d32", "timestamp": "2026-02-19T09:45:42+09:00", "summary": "ウィザード形式の年月バリデーション修正およびプリフライト情報の統合", "intent": "ウィザード操作中のデータ整合性を確保するため、タイマーによる自動実行を停止し、UI上の情報を整理・統合する。", "new_rules": ["ウィザード操作を前提とするスキルでは、起動時に core_scheduler.stop_worker() を呼び出し、タイマーによる自動実行を明示的に無効化する。", "年月(YM)のバリデーションはウィザードの入力フローに適合させ、不整合な状態での進行を防止する。"], "anti_patterns": ["ユーザーがウィザードで対話的な操作を行っている最中に、バックグラウンドで非同期の自動処理を並行して稼働させる（データの競合や予期せぬ上書きのリスクがあるため）。"], "debt": ["タイマー実行を再開するための条件や、手動実行と自動実行の切り替えに関する運用ポリシーの定義。", "プリフライト情報をターゲットカードに統合したことによる、UIの複雑化や情報の視認性への影響評価。"], "scope": ["mfcloud-expense-receipt-reconcile スキルのダッシュボードおよびスケジューラ制御", "ウィザード形式の入力バリデーションロジック"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "fc271b473adb1e79f076c0496ae69d8febadb964", "timestamp": "2026-02-19T09:52:05+09:00", "summary": "テンプレートレベルでの月の値のバリデーション（クランプ処理）の導入", "intent": "バックエンドのサニタイズ処理が何らかの理由でバイパスされた場合でも、UI上で不正な月（1-12以外）が表示・送信されるのを防ぐ多重防御（Defense in Depth）の実装。", "new_rules": ["Jinja2テンプレート内で月（month）を扱う際は、`| int` でキャストした上で1〜12の範囲内に収まるようクランプ処理を行う。", "HTMLの `input type=\"number\"` の `min`/`max` 属性だけでなく、初期値（value属性）自体もテンプレート側で安全な値に制限する。"], "anti_patterns": ["バックエンドのバリデーションを過信し、テンプレート側で生の変数をそのまま `value` 属性に流し込むこと。", "hidden属性のinput要素に対して、範囲外の値をそのまま保持させること。"], "debt": ["複数のテンプレート（index.html, expense_workflow_copy.html）で同様のクランプ処理が重複している。共通のJinja2マクロまたはカスタムフィルタとして共通化を検討すべき。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/templates/"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "39967571dfb302c470b3d9499169a7cbccb6d830", "timestamp": "2026-02-19T09:59:02+09:00", "summary": "経費精算ワークフロー画面からのスケジューラUI（タイマー自動実行設定）の削除", "intent": "ユーザーインターフェースの簡素化、または当該ワークフローにおける自動実行設定機能の無効化に伴うUIコンポーネントおよび関連スクリプトの除去。", "new_rules": ["mfcloud-expense-receipt-reconcileのダッシュボード（index.html）にはスケジューラUI（scheduler-panel、scheduler-toggle等）を配置しない。", "当該ページのHTMLで /static/js/scheduler.js をロードしない。", "ダッシュボードのテストコードでは、スケジューラ関連のIDや属性が存在しないことを検証する。"], "anti_patterns": ["明確な再導入の指示がない限り、削除されたスケジューラ関連のHTML要素やJavaScript参照を復元すること。"], "debt": ["サーバーサイドにスケジューラ実行用のAPIやロジックが残存している可能性があるが、今回の差分からは不明。", "プロジェクト全体で scheduler.js が不要になったのか、このスキル固有の変更なのかの確認が必要。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/templates/index.html", "skills/mfcloud-expense-receipt-reconcile/tests/test_dashboard_pages.py"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "8290c89ebc62c52f0f118b7ef5a231b7a99f178f", "timestamp": "2026-02-19T10:11:50+09:00", "summary": "ワークスペースの追加リンク機能における文言の日本語統一、およびピン留めリンク機能の導入と状態管理の更新。", "intent": "UIの文言を日本語に統一してユーザー体験を向上させるとともに、最大6件までのピン留めリンク機能をサポートし、リスト描画ロジックを共通化する。", "new_rules": ["ピン留めリンクの最大数は6件（MAX_PINNED_LINKS）に制限する。", "リンクの追加・削除・全削除などの状態変更時には、必ず `clearLinkUndoNotice` を呼び出して取り消し通知の状態をリセットする。", "リンク一覧の描画には `renderLinkLists` を使用し、通常リンクとピン留めリンクの双方を同期して更新する。"], "anti_patterns": ["リンク更新処理において `clearLinkUndoNotice` の呼び出しを漏らすこと（UI上の通知不整合の原因となる）。", "ピン留めリンクの上限（6件）を定数 `MAX_PINNED_LINKS` 以外でハードコードすること。"], "debt": ["コミットメッセージが「文言の日本語統一」となっているが、実際にはピン留め機能のロジック変更や定数追加が含まれており、変更内容とメッセージに乖離がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/workspace.js"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "bfb99aaafcfcc544986f2161571b474c6c82d272", "timestamp": "2026-02-19T10:14:01+09:00", "summary": "AGENT_BRAINの更新と、ワークスペースダッシュボードAPIにおける固定リンク(pinned_links)対応およびワークフロー正規化ルールの適用。", "intent": "ワークフローテンプレートMVP実装に向けたデータ整合性の強化と、ダッシュボードのカスタマイズ性向上（固定リンク機能）のため。", "new_rules": ["APIレスポンス返却前に、ワークフローのステップ情報は必ず正規化関数（_normalize_workflow_template_steps等）を介在させること。", "サイドバーのリンク情報は、HTMLのdata-sidebar-links属性を用いたJSON形式での受け渡しを維持すること。", "ワークフローのコピー・編集画面において、template_idとtemplate_modeの初期値設定を厳密に管理し、テストで検証すること。", "ワークスペースの状態管理において、pinned_links（固定リンク）をサポートし、リビジョン競合時のマージ対象に含めること。"], "anti_patterns": ["正規化されていない生のDBデータを直接フロントエンドに返却すること。", "アクティブなワークフローとアーカイブ済みワークフローの操作ロジックを、分離せずに同一のJS/テンプレートに混在させること。"], "debt": ["正規化ロジックが複数のAPIエンドポイントに分散しており、共通化の余地がある。", "ワークスペースリンクの昇格（promotion）に伴う大規模な構造変更が予定されている。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/", "docs/AGENT_BRAIN.md"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "67ca33ef39d708a341cc1e0d715627d401d730ed", "timestamp": "2026-02-19T10:19:36+09:00", "summary": "PowerShellにおけるファイル書き出し時のエンコーディングをUTF-8 (BOMなし) に統一する方針の策定と自動チェックの導入", "intent": "PowerShellの標準コマンド（Set-Content等）の `-Encoding utf8` がBOM付きになる、あるいは環境依存の挙動を示すことによる文字化けを防ぐため、明示的にBOMなしUTF-8を指定する実装を強制する。", "new_rules": ["PowerShellでファイルを書き出す際は Set-Content/Add-Content/Out-File -Encoding utf8 を使用しない。", "代わりに [System.Text.UTF8Encoding]($false) を使用した .NET の [System.IO.File]::WriteAllText() 等、または utf8NoBOM を明示的に使用する。", ".ps1 ファイルに対するエンコーディングチェック（scripts/check_text_encoding.py）をパスさせること。"], "anti_patterns": ["PowerShellスクリプト内での -Encoding utf8 オプションの使用（BOMが付与される可能性があるため）。", "UTF-8 BOM付きでのファイル保存。"], "debt": ["正規表現による静的チェック（DISALLOWED_POWERSHELL_ENCODING_PATTERN）であるため、動的なコマンド生成や特殊なエイリアス使用による回避を完全には捕捉できない可能性がある。"], "scope": ["リポジトリ内の全PowerShellスクリプト（.ps1）", "エンコーディング管理方針（README.md）", "CI/プリコミット時のエンコーディングバリデーション"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "399252e1fd3bd3823e4f2ff2e43f984dc45ac806", "timestamp": "2026-02-19T10:20:58+09:00", "summary": "ダッシュボードのJavaScriptファイルにおける文字化けの修正", "intent": "dashboard/static/js/index.js 内のハードコードされた日本語テキストが文字化けしていたため、正しい表記に復元し、UIの視認性を改善する。", "new_rules": ["日本語等のマルチバイト文字を含むソースファイルは、必ず UTF-8 (BOMなし) エンコーディングで保存する。", "UIテキストの修正を含むコミットを行う際は、ブラウザ上での表示確認を必須とする。"], "anti_patterns": ["エディタの自動判別ミスによる文字化け（Mojibake）を含んだ状態でのコードコミット。", "BOM（Byte Order Mark）付きのUTF-8での保存（一部のツールや環境で予期せぬ動作を引き起こす可能性があるため）。"], "debt": ["UIコピー（文言）がJavaScriptファイル内に直接ハードコードされており、エンコーディング問題の影響を受けやすい。i18n（国際化）対応による文言の外部管理化が望ましい。", "パッチ内で修正されていない他のラベル（preflight, amazon_decide_print等）にも文字化けが残存している可能性がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/index.js"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "f5d813f2e33545e316d932fe5a993efa4642739b", "timestamp": "2026-02-19T10:43:03+09:00", "summary": "ダッシュボードのフロントエンドJavaScriptを機能別にモジュール化", "intent": "巨大化した index.js を、API通信、定数、イベント、描画、状態管理の各役割に分離し、コードの保守性と可読性を向上させる。", "new_rules": ["ダッシュボードのフロントエンド機能を追加・修正する際は、役割に応じたファイル（index.api.js, index.render.js等）にロジックを分散させること。", "HTMLテンプレートでスクリプトを読み込む際は、依存関係を考慮した特定の順序（constants -> state -> api -> render -> events -> index）を厳守すること。"], "anti_patterns": ["index.js に全てのロジックを直接記述し、肥大化させること。", "モジュール間の依存関係を無視して、HTML内でのスクリプト読み込み順序を変更すること。"], "debt": ["ES Modules (import/export) を使用せず、グローバルスコープでの関数・変数共有に依存しているため、名前衝突のリスクがある。", "ビルドツール（Webpack/Vite等）が導入されていないため、ファイル分割によるHTTPリクエスト数の増加が発生している。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "cc64d00af2464be6309201131a5f0da517ebcd74", "timestamp": "2026-02-19T11:03:30+09:00", "summary": "APIおよびサービス層の巨大なモジュールを機能単位で分割し、互換性を維持するためのリファクタリングの実施。", "intent": "コードの可読性と保守性を向上させるため、api.pyやcore_runs.pyをエンドポイントや機能（監査、エンジン、バリデーション等）ごとに細分化し、分割後のシンボル露出をテストで保証する。", "new_rules": ["APIエンドポイントやサービスロジックが肥大化した場合は、機能カテゴリ（folder, print, run, workflow等）ごとにファイルを分割して管理する。", "フロントエンド（JavaScript）とバックエンドのインターフェース（グローバル変数やイベント名）の整合性を確認するためのコントラクトテストを導入・維持する。", "モジュール分割時は、既存のAPIパスやシンボル定義が維持されているかを検証するテストコードをセットで作成する。"], "anti_patterns": ["1つのファイルに数千行規模のロジック（API定義やビジネスロジック）を詰め込み、単一責任原則に反する状態を放置すること。", "フロントエンドが依存するJS側のグローバルシンボル（window.DashboardIndexEvents等）の定義有無を確認せずにリファクタリングを完了すること。"], "debt": ["分割された各モジュール間での循環参照が発生しないよう、共通ヘルパー（api_helpers.py等）への依存関係を継続的に監視する必要がある。", "既存のテストコードが分割後の全エンドポイントを網羅できているかの再確認。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/", "skills/mfcloud-expense-receipt-reconcile/dashboard/services/", "skills/mfcloud-expense-receipt-reconcile/tests/"], "confidence": 0.9, "risk": "medium", "review_deadline": "2026-03-19", "source": "llm"}
{"commit": "3fc643af990dbdb1639f5d3e96e21ebe2257da42", "timestamp": "2026-02-19T11:06:19+09:00", "summary": "APIエンドポイント登録における循環参照の解消と依存性注入の導入", "intent": "api.py と api_folder_endpoints.py の間での相互インポート（循環参照）を排除し、モジュールの結合度を下げて保守性を向上させる。", "new_rules": ["サブモジュールが親モジュールや兄弟モジュールの関数を必要とする場合、直接インポートせず、登録用関数の引数として Callable（コールバック）を渡す依存性注入（DI）パターンを採用する。", "DI用の引数には型ヒント（Callable[[...], ...], Any等）を明示し、インターフェースを定義する。"], "anti_patterns": ["同一パッケージ内のルート定義モジュール間で相互に import を行い、実行時エラーや初期化の複雑化を招くこと。", "循環参照を避けるために、関数内でローカルインポートを多用すること（DIの方が追跡可能性が高い）。"], "debt": ["他の register_api_* 関数群においても同様の密結合が存在する可能性があり、必要に応じてDIパターンへの統一を検討すべきである。", "api.py 内で定義されたプロキシ関数（_provider_source_status_for_ym_proxy）が増加した場合、管理用のファクトリや設定クラスへの集約が必要になる可能性がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "9a6dddc35403fd90833a9c68b2d3b4595cc7bd29", "timestamp": "2026-02-19T11:08:13+09:00", "summary": "APIルーターにおけるプロバイダーソース状態解決関数のインジェクションを検証するコントラクトテストの追加。", "intent": "create_api_routerがregister_api_folder_endpointsに対して、期待されるリゾルバー(provider_source_status_for_ym)を正しく注入し、それがモジュール内部の関数へ適切に委譲されていることを保証する。", "new_rules": ["APIルーターの構築ロジック（create_api_router等）を変更する場合、依存するエンドポイント登録関数への引数注入が正しく行われているかを確認するテストを含めること。", "注入されるコールバック関数が、内部の実装関数（_provider_source_status_for_ym等）を正しく呼び出しているかを検証すること。"], "anti_patterns": ["エンドポイント登録関数のシグネチャ変更時に、呼び出し元（ルーター構築部）のテストを更新せず、実行時のインジェクションエラーを見逃すこと。"], "debt": ["テスト内で多数のモック（_fake_endpoints）を手動定義しており、APIエンドポイントのカテゴリが増えるたびにテストコードのボイラープレートが増加する可能性がある。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/tests/test_dashboard_contract.py", "APIルーティング定義"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "97e8d23894e3dcb4957841827b1709c3b2d38df2", "timestamp": "2026-02-19T11:57:38+09:00", "summary": "PPTXブラッシュアップ機能の追加と、スキル専用ページの共通アーキテクチャの導入", "intent": "特定のスキル機能をダッシュボードに統合し、今後のスキル追加を容易にするための拡張可能なディレクトリ構造（skill_pages）とサイドバー連携の仕組みを構築する。", "new_rules": ["スキル固有のページロジックは `dashboard/skill_pages/` 配下にカプセル化して実装すること。", "サイドバーのリンク情報は、HTMLの `data-sidebar-links` 属性を用いたJSON形式での受け渡しを維持し、フロントエンドで動的に生成すること。", "新しいスキルページを追加する際は、`pages.py` でのルーティング定義と、サイドバーへのリンク定義（href, tab, section）をセットで行うこと。"], "anti_patterns": ["スキル固有の複雑なビジネスロジックを `routes/pages.py` に直接記述し、肥大化させること。", "サイドバーのリンク情報をHTMLテンプレート内にハードコードして個別に定義すること。"], "debt": ["skill_pages アーキテクチャにおける各スキルクラスの共通インターフェース（Baseクラス等）の厳密な定義。", "pptx_polish_portable.py のポータブル性の検証と、他スキルへの再利用性の向上。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "07ec4341720e3f80bdb2d7da8168d95f445f21eb", "timestamp": "2026-02-19T11:57:48+09:00", "summary": "PPTX整形ジョブのステータスメッセージにおける文字化けの解消とファイルエンコーディングの修正", "intent": "実行ログやUIに表示される文字化けを修正し、システムの可読性と信頼性を確保する。また、Pythonソースコードから不要なBOMを削除する。", "new_rules": ["ジョブの進捗メッセージなどのシステム内部から出力されるメッセージには、エンコーディングトラブルを避けるため原則として英語を使用するか、UTF-8（BOMなし）を厳守する。", "Pythonソースファイルの保存形式はBOMなしUTF-8とし、ファイル先頭に不要な制御文字を含めない。"], "anti_patterns": ["非ASCII文字を含むメッセージを、実行環境のエンコーディングが不明確な状態でハードコードすること。", "BOM付きUTF-8でPythonソースコードを保存すること。"], "debt": ["他のエンドポイントやモジュールにおいても同様の文字化けが発生していないかの横断的な確認。", "ハードコードされたメッセージの国際化（i18n）対応。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/api_print_endpoints.py", "ジョブステータス通知メッセージ管理"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "9b21f4ab255702b02f30f4dd22c820824cd80421", "timestamp": "2026-02-19T11:58:04+09:00", "summary": "AGENT_BRAINドキュメントを最新のスキル追加およびアーキテクチャ変更（PPTX整形機能、スキル専用ページ構成、エンコーディング規則）に同期しました。", "intent": "開発・運用知識の集約場所であるAGENT_BRAINを最新化し、今後のスキル追加やメンテナンスにおける一貫性を確保する。", "new_rules": ["スキル固有のページロジックは `dashboard/skill_pages/` 配下にカプセル化して実装すること。", "サイドバーのリンク情報は、HTMLの `data-sidebar-links` 属性を用いたJSON形式での受け渡しを維持し、フロントエンドで動的に生成すること。", "Pythonソースファイルの保存形式はBOMなしUTF-8を厳守し、システム内部メッセージには原則として英語またはUTF-8（BOMなし）を使用すること。"], "anti_patterns": ["スキル固有の複雑なビジネスロジックを `routes/pages.py` に直接記述し、ファイルを肥大化させること。", "サイドバーのリンク情報をHTMLテンプレート内にハードコードして個別に定義すること。", "非ASCII文字を含むメッセージを、実行環境のエンコーディングが不明確な状態でハードコードすること。"], "debt": ["skill_pages アーキテクチャにおける各スキルクラスの共通インターフェース（Baseクラス等）の厳密な定義。", "ハードコードされたメッセージの国際化（i18n）対応。", "pptx_polish_portable.py のポータブル性の検証と、他スキルへの再利用性の向上。"], "scope": ["docs/", "skills/mfcloud-expense-receipt-reconcile/dashboard/"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "2d7e074ff634e4c8eded61630e675dbabf45ca1c", "timestamp": "2026-02-19T13:46:55+09:00", "summary": "ワークスペースのピン留めグループ管理機能の刷新と、削除確認UIの日本語化対応", "intent": "リンク管理の単位を「グループ」へ変更して整理し、ユーザー体験向上のためのローカライズと、開発環境のクリーンアップ（.gitignore）を実施する。", "new_rules": ["ワークスペースのピン留め管理には 'pinned-groups' という命名・ID体系を使用する", "削除確認ダイアログ等のUIメッセージは日本語で実装する", "開発時の一時ファイル（tmp_*, workspace_*.js, ws.diff, *.bak等）はリポジトリに含めない"], "anti_patterns": ["ワークスペースのグループ管理に旧称の 'pinned-links' を使用すること", "作業用のスクラッチファイルやバックアップファイルをコミットに含めること"], "debt": ["スケジューラー関連コンポーネントの整理（一部テストで削除された要素の整合性確認と、不要になったJS/CSSのクリーンアップ）"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/", ".gitignore", "docs/AGENT_BRAIN.md"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "03cf36666128fffafb45af98d3cd17f55ce9f4e9", "timestamp": "2026-02-19T13:55:03+09:00", "summary": "Skillディレクトリ構造の標準化とベースライン定義、およびスクリプト型Skillへのテスト導入", "intent": "Skillの品質と保守性を向上させるため、ディレクトリ構成の制約（SKILL.md, skill.yamlの必須化等）を明文化し、自動チェックとテストコードを整備する。", "new_rules": ["各Skillディレクトリには 'SKILL.md' と 'skill.yaml' を必須とする。", "Skillの構成要素として 'scripts' および 'tests' ディレクトリを標準的なオプションとして定義する。", "Skillの準拠状況は 'docs/skill-structure-baseline.json' で管理し、'scripts/check_skill_structure.py' で検証する。"], "anti_patterns": ["メタデータファイル（SKILL.md, skill.yaml）が欠落した状態でのSkillの新規作成。", "共通のパース処理（日付、金額、CSV等）をテストコードなしで実装すること。"], "debt": ["全Skillが標準構造に完全準拠しているわけではなく、'docs/structure-refactor-roadmap.md' に基づく段階的なリファクタリングが必要。", "構造チェックスクリプトのCIパイプラインへの完全な統合。"], "scope": ["skills/ 配下の全ディレクトリ", "docs/ 構造管理ドキュメント", "scripts/ 構造チェックツール"], "confidence": 0.9, "risk": "low", "review_deadline": "2026-03-19", "source": "llm"}
{"commit": "8414c4c46fbf1c5dbfb36d3d00f9268b3781c1d0", "timestamp": "2026-02-19T13:56:08+09:00", "summary": "Skillディレクトリ構造の厳格なチェックを行うCIワークフローの導入", "intent": "スキルの構成がプロジェクト標準に準拠していることを自動検証し、不整合や不要な制御文字（BOM等）の混入を未然に防ぐ。", "new_rules": ["Skillのディレクトリ構造は `scripts/check_skill_structure.py --strict` による検証をパスしなければならない。", "ファイル保存時にBOM（Byte Order Mark）を含めないように徹底する。"], "anti_patterns": ["CIの構造チェックをバイパスするようなディレクトリ構成の変更。", "エディタ設定による意図しないBOM（Byte Order Mark）の付与。"], "debt": ["scripts/check_skill_structure.py が定義する具体的なバリデーションルール（必須ファイル等）のドキュメント化。"], "scope": [".github/workflows/skill-structure-check.yml", "skills/ 配下のディレクトリ構造およびファイル形式"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "14c4eda98ca2b30ff57d3fe2069d62b91ba5b6db", "timestamp": "2026-02-19T13:58:29+09:00", "summary": "ダッシュボードの500エラー修正（変数名衝突の解消とテンプレートの文字化け修正）", "intent": "関数名と同一の変数名を使用することによる実行時エラー（UnboundLocalError等）の防止、およびUI表示の正常化。", "new_rules": ["ユーティリティ関数名（例: safe_incident_id）と同一の変数名をローカルスコープで使用しない。resolved_incident_id 等の明確に区別できる変数名を採用すること。", "HTMLテンプレートのデフォルト値やメタデータに文字化けした文字列（mojibake）を含めない。必要に応じて英語表記または適切なエンコーディングの日本語を使用する。"], "anti_patterns": ["関数名を変数名で上書き（シャドウイング）し、同一スコープ内での再利用を不可能にする実装。", "開発環境のエンコーディング不備に起因する不正な文字列のコミット。"], "debt": ["外部スクリプト（error_status.py, error_plan_generate.py等）をサブプロセスとして呼び出しており、引数構造の変更に対して脆弱な構造になっている。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/routes/api_runs.py", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/index.html"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "f3c5c9ab8e465855ee44ad609f0b5014707383fb", "timestamp": "2026-02-19T14:09:49+09:00", "summary": "mf_reconcileステップの削除とダッシュボードの文字化け修正", "intent": "不要なワークフローステップを削除してプロセスを簡素化し、ソースコード内のマルチバイト文字列のエンコーディング異常（文字化け）を解消してUIの表示を正常化する。", "new_rules": ["Pythonソースコード内の日本語文字列は、文字化けを防ぐため適切なエンコーディング（UTF-8）で保存・管理し、コミット前に表示を確認すること。", "ワークフローの必須ステップ定義（WORKFLOW_TEMPLATE_REQUIRED_STEP_ACTIONS等）を更新した際は、関連するテストコードの期待値も同期させること。"], "anti_patterns": ["不適切なエンコーディングによるマルチバイト文字（文字化け）の混入。", "削除済みのワークフローアクションを必須定義やテンプレート内に残存させること。"], "debt": ["mf_reconcileステップの削除に伴う、外部ドキュメントやユーザーマニュアルの更新要否の確認。", "テストコード内でのUI要素（scheduler-panel等）の存在確認ロジックの整理。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard", "skills/mfcloud-expense-receipt-reconcile/tests"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "ee9cacc6409dba4aac0f4feef97f1bf197b4bf72", "timestamp": "2026-02-19T14:13:47+09:00", "summary": "非ASCII文字を含むファイルパスをGitコマンドから正確に取得するための修正", "intent": "Gitのデフォルト出力では非ASCII文字がエスケープ（クォート）される可能性があるため、-zオプションとヌル文字区切りを使用して、パスの整合性を保つ。", "new_rules": ["Gitコマンドでファイルパス一覧を取得する際は -z オプションを使用し、ヌル文字で分割する。", "subprocessでGit出力を扱う際は text=False でバイト列として取得し、明示的にデコードする。"], "anti_patterns": ["Gitのパス出力を標準の改行区切りや text=True でパースすること（非ASCII文字がクォートやエスケープされるリスクがあるため）。"], "debt": ["プロジェクト内の他のスクリプトにおけるGitパス取得処理の横断的な確認。"], "scope": ["scripts/check_text_encoding.py", "Git操作を含むPythonスクリプト"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "dbcef8066ae8a3210e0367a254344602d1b8c09a", "timestamp": "2026-02-19T14:19:30+09:00", "summary": "ワークフロータスクカードのUI改善（コンパクト/詳細表示の切り替え機能追加とラベルの標準化）", "intent": "タスクごとの自動タイマー設定をデフォルトで非表示にし、必要に応じて「+」ボタンで切り替えるUIを導入することで、画面の煩雑さを解消し、操作性を向上させる。", "new_rules": ["トグルボタンのラベルには標準的なハイフン「-」を使用し、全角文字や特殊なマイナス記号を避ける。", "MVPフェーズにおける機能制限（自動実行の未実装など）は、UI上の注釈（data-template-step-mvp-note）でユーザーに明示する。"], "anti_patterns": ["UIのラベルや定数に、視覚的に区別がつきにくい特殊文字（全角マイナス「−」など）を混在させること。"], "debt": ["タイマー機能の自動実行ロジックは未実装であり、現在はUI上の設定保存のみにとどまっている。", "注釈テキストが英語に変更されたが、プロジェクト全体の多言語対応方針との整合性確認が必要。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/components/expense_workflow_card.html"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "0b85804d4fb17bf8cd730ee40ac6308e9aa651b3", "timestamp": "2026-02-19T14:20:36+09:00", "summary": "ダッシュボードの起動障害（構文・依存関係）の修正およびワークスペース管理機能の整理", "intent": "起動を妨げる構文エラーや依存ライブラリの不整合を解消し、ピン留めグループ管理機能の刷新に伴う不要なUI要素（追加ボタン等）を削除する。", "new_rules": ["ワークスペースのピン留め管理には 'pinned-groups' という命名・ID体系を統一して使用する", "UIメッセージ（削除確認ダイアログ等）は日本語で実装する"], "anti_patterns": ["開発時の一時ファイル（tmp_*, workspace_*.js, ws.diff, *.bak等）をコミットに含めること", "ワークスペースのグループ管理に旧称の 'pinned-links' を使用すること"], "debt": ["スケジューラー関連コンポーネントの整理（一部テストで削除された要素の整合性確認）", "不要になったJS/CSSのクリーンアップ"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/", "docs/"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "ceb08e8b00c3652fa97d6575e7ff3bee33534330", "timestamp": "2026-02-19T15:16:08+09:00", "summary": "ワークフローのプリセットステップ注入の廃止とエラーページの堅牢化", "intent": "ワークフロー定義の暗黙的な挙動を排除して明示的な管理へ移行し、エラー表示画面の堅牢性を高めることでユーザー体験の安定性を向上させる。", "new_rules": ["ワークフローのコピーまたは新規作成時、template_id や template_source_id は必ずクリアし、意図しないデータの引き継ぎを防止する。", "エラー表示ロジックにおいて、データが欠落している場合や予期しない形式の場合でも画面がクラッシュしないようガードを実装する。", "フロントエンドの状態管理（index.state.js等）において、APIレスポンスの整合性を厳格にチェックする。"], "anti_patterns": ["プリセットによる暗黙的なステップ注入に依存したワークフローの実装。", "コピー元のメタデータ（ID等）を保持したまま編集モードへ遷移させること。", "エラーハンドリングにおいて、バックエンドからの不完全なデータ受信を考慮しない実装。"], "debt": ["既存のワークフロー定義の中で、削除されたプリセット注入に依存していた箇所の有無の最終確認。", "エラーページの堅牢化（hardening）手法の、他のダッシュボードページへの共通化・横展開。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard", "skills/mfcloud-expense-receipt-reconcile/scripts/error_common.py"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "18795a01b68e18cc0741dce68f2450def14e5736", "timestamp": "2026-02-19T16:06:35+09:00", "summary": "AIチャット・スキル制御機能の追加とPlaywright実行基盤の導入", "intent": "ダッシュボードからのAI操作インターフェースの提供と、Playwrightによるブラウザ自動化を標準化されたスクリプトで実行可能にすること。", "new_rules": ["APIエンドポイントは機能単位で別ファイル（api_ai_chat_routes.py等）に分割し、register関数を用いて api.py に統合する。", "Playwright実行時は、--session 引数または環境変数 PLAYWRIGHT_CLI_SESSION を通じてセッションを管理する。", "外部プロセス実行スクリプトでは、タイムアウト設定と実行ディレクトリ（cwd）の動的な指定をサポートする。"], "anti_patterns": ["api.py への直接的なルートロジックの記述（ファイル肥大化の防止）。", "Playwright実行時におけるセッション情報のハードコーディング。"], "debt": ["subprocess.run において check=False が指定されており、エラー時の詳細な原因切り分けが呼び出し側に依存している。", "AIチャットのプロンプト管理やモデルパラメータの外部設定化。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard", "skills/playwright"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "ec94b8a793ebff4441bc7ca8442fdc08e1443f99", "timestamp": "2026-02-19T16:16:17+09:00", "summary": "ダッシュボードのレイアウト拡張、サイドバー制御ロジックの最適化、およびUIの日本語化", "intent": "ワークスペースの表示領域を最大化するため、サイドバーやチャット欄の幅を縮小しつつ全体の最大幅を拡張。また、サイドバーの「自動」モードにおいて、ビューポートの種類が変化した際のみ状態をリセットするよう制御を改善した。", "new_rules": ["UIラベルおよびアクセシビリティ用ラベル（aria-label）は日本語を標準とする。", "サイドバーの「自動（AUTO）」モード制御では、ビューポートの種類（mobile/tablet/desktop）が変更されたタイミングでのみ状態をデフォルトに戻し、同一ビューポート内でのリサイズでは状態を維持する。", "レイアウト設計時は、clamp関数等を用いてワークスペースの有効面積を優先的に確保する。"], "anti_patterns": ["ビューポートの種類が変わらない微細なウィンドウリサイズにおいて、ユーザーが手動で切り替えたサイドバーの状態を強制的にリセットすること。", "固定のピクセル値のみを使用し、高解像度ディスプレイでのワークスペース拡張性を損なうこと。"], "debt": ["UIテキストがJS内に直接日本語でハードコードされており、将来的な多言語対応（i18n）の際にリファクタリングが必要。", "JS側のビューポート判定閾値とCSS側のメディアクエリの閾値の二重管理による不整合のリスク。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/common.js", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/styles/layout.css"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "bbc6c99ab98c4a7d7a885cdd8f0fe3b3f287d870", "timestamp": "2026-02-19T16:30:00+09:00", "summary": "ワークスペースのプロンプトをクリップボードにコピーする代わりに、サイドバーのAIチャットへ直接送信する機能の実装。", "intent": "ユーザーがプロンプトを手動で貼り付ける手間を省き、シームレスなAI対話体験を提供することでUXを向上させる。", "new_rules": ["AIチャットへのメッセージ送信には Common.sendAiChatMessage(text) を使用する。", "送信前にメッセージが空でないこと、および4000文字以内であることをバリデーションする。", "sendAiChatMessage は内部でサイドバーの初期化状態を確認し、未初期化なら自動で initAiChatSidebar を呼び出す。", "AIチャットが応答待ち（pending）の状態では、重複送信を避けるため送信を中断し、ユーザーに通知する。"], "anti_patterns": ["初期化処理を考慮せずに sendAiChat を直接呼び出すこと。", "4000文字を超える長大なプロンプトを制限なしに送信しようとすること。", "AIの応答中に連続してメッセージを送信すること。"], "debt": ["common.js 内で aiChatUi をモジュールレベルの変数として保持しており、将来的に複数のチャットインスタンスが必要になった場合に拡張性が制限される。", "送信成功・失敗時のメッセージがJavaScriptコード内にハードコードされている。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/common.js", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/workspace.js", "skills/mfcloud-expense-receipt-reconcile/dashboard/templates/workspace.html"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "9df04327107d49bf5b6baf135f6a69f5b6bd0a58", "timestamp": "2026-02-19T17:40:29+09:00", "summary": "SKILL.mdの指示文の日本語正規化、およびスプレッドシート操作における書式規約とスキル使い分けルールの定義。", "intent": "スキル指示の言語的一貫性の向上と、財務モデリング等の高度なExcel操作における品質基準（色分け、レイアウト、スキル選択基準）の明確化。", "new_rules": ["SKILL.md内の指示文やコメントは日本語に正規化する（例：dry-run -> ドライラン）。", "スプレッドシートの色分け規約を遵守する：青（入力）、緑（連携）、灰（固定定数）、橙（要確認）、薄赤（エラー）、紫（制御）、ティール（KPI）。", "財務向け表示規約：ゼロは「-」、負数は赤字かつ括弧付き、ヘッダーに単位明記、生データに出典コメントを付与する。", "IB（投資銀行）スタイルレイアウト：合計行は直上合算、グリッド線非表示、見出しは濃色背景＋白文字、サブ指標はインデントする。", "スキル選択：財務モデリングや厳格な規約が必要な場合は `xlsx`、軽量なデータ加工・分析は `spreadsheet` を優先する。"], "anti_patterns": ["財務モデリングや監査が必要な業務で、厳格な規約を無視して `spreadsheet` スキルを安易に選択すること。", "SKILL.md内の実行例や手順説明において、英語と日本語の指示を混在させること。"], "debt": ["既存の全スキルファイルが新しい日本語正規化ルールや書式規約に完全に対応できているかの網羅的な確認。", "`spreadsheet` と `xlsx` の境界線における判断基準の運用を通じた微調整。"], "scope": ["skills/ 以下の全SKILL.md", "スプレッドシート操作（spreadsheet, xlsx）", "財務・会計関連の自動化タスク"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "4355416f514814bd7c78734671b978e52b5efdb4", "timestamp": "2026-02-19T17:43:22+09:00", "summary": "portable-codex-skills（pptx/xlsx）のドキュメント翻訳および、xlsxとspreadsheetスキルの使い分けルールの定義", "intent": "日本語環境でのスキル利用の円滑化と、財務モデル等の厳格な要件におけるxlsxスキルの優先適用基準を明確化すること", "new_rules": ["財務モデル（DCF/LBO等）、厳格な品質管理、数式中心、監査性が重視される場合は `xlsx` スキルを選択する", "軽量なデータ加工、探索的分析、CSV/TSV中心のタスクには `spreadsheet` スキルを選択する", "精度や追跡可能性が必要で判断に迷う場合は `xlsx` スキルを優先する", "データ探索を `spreadsheet` で行い、最終的な成果物の仕上げや規約適用を `xlsx` で行うという段階的運用を許容する"], "anti_patterns": ["厳格な規約や数式の整合性が求められる成果物に対して、軽量な `spreadsheet` スキルのみで完結させること", "単純なデータ変換タスクに対して、オーバーヘッドの大きい `xlsx` スキルの厳格な規約を強制すること"], "debt": ["portable版ドキュメントのローカライズに伴い、本体側のSKILL定義との乖離が発生した場合の同期プロセス"], "scope": ["skills/portable-codex-skills/pptx/SKILL.md", "skills/portable-codex-skills/xlsx/SKILL.md"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "6505a3556384f1b0c716ee8b9ed237b4582731a4", "timestamp": "2026-02-19T19:27:23+09:00", "summary": "AIチャットの履歴正規化と永続化の同期、およびUIレイアウトの最適化", "intent": "localStorage内のデータ不整合を自動修復して同期すること、およびAIチャットの視認性向上のための幅調整とレスポンシブブレークポイントの変更", "new_rules": ["localStorageから取得したデータの正規化結果が元のデータと異なる場合、正規化後のデータを再保存して永続化層と同期する", "localStorageの操作（setItem, removeItem）は、プライベートモード等で利用不可な場合に備え、必ずtry-catchで保護する", "AIチャットの標準幅は clamp(300px, 24vw, 340px) を基準とし、以前より広めに確保する"], "anti_patterns": ["Array.isArray を Number.isArray と誤記すること", "localStorageのパースエラー時に、破損したデータを削除せずに放置すること", "localStorageが利用できない環境で例外をハンドリングせず、処理を中断させること"], "debt": ["localStorageが利用不可な場合のデータ永続化手段はなく、in-memory保持に限定される制約がある"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/common.js", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/workspace.js", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/styles/layout.css"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "3e9f061a8395e57144a72136d7ff427b0ff57ee5", "timestamp": "2026-02-19T19:35:59+09:00", "summary": "API実行（runnerあり）とエージェント実行（SKILL.mdベース）の制約分離とスキル探索ロジックの改善", "intent": "スキルがAPIとして実行可能か、あるいはエージェントによる解釈実行のみ可能かを明確に区別し、ユーザーおよびエージェントに適切な実行手段を提示するため。また、不要なディレクトリを探索対象から除外する。", "new_rules": ["API実行には scripts/run.py, run.ps1, run.mjs, run.js のいずれかのランナーファイルが必須である。", "ランナーが存在しないスキルであっても、SKILL.mdが存在すれば『エージェント実行可能』として扱う。", "スキル探索時、'.git', 'node_modules', 'venv', '.venv', '__pycache__' およびドットで始まるディレクトリは無視する。", "スキルIDの決定には、SKILL.mdのフロントマター内の 'name' を優先し、存在しない場合にのみディレクトリ名を使用する。"], "anti_patterns": ["ランナー（scripts/run.*）がないことを理由に、スキルを完全に『利用不可』と判定・表示すること（SKILL.mdがあればエージェントが利用できるため）。", "依存ライブラリやソース管理用のディレクトリ（node_modules等）をスキルディレクトリとしてスキャンすること。"], "debt": ["UIメッセージが英語でハードコードされており、多言語対応（i18n）の枠組みが未整備。", "スキルIDが重複した場合の解決策が『最初に見つかったものを優先』という簡易的な実装に留まっている。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/dashboard/services/ai_skill_tools.py", "skills/mfcloud-expense-receipt-reconcile/dashboard/routes/api_ai_chat_routes.py", "skills/mfcloud-expense-receipt-reconcile/dashboard/static/js/errors.js"], "confidence": 0.95, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "5f06e5df11eb8b78db5572044e821e8d3a3995e1", "timestamp": "2026-02-19T19:40:03+09:00", "summary": "AIスキルの実行用ラッパー（xlsx/pptx）の追加と、階層構造を持つスキル探索ロジックの導入", "intent": "AIスキルの実行環境を標準化し、依存関係のセルフチェック機能やタイムアウト管理を備えた共通ラッパーを提供することで、スキルの可搬性と運用性を向上させる。", "new_rules": ["スキルディレクトリ内に `scripts/run.py` が存在する場合、そのスキルは実行可能（has_runner=True）かつ許可済み（allowed=True）として扱う。", "同一のスキルIDが複数箇所に存在する場合、ファイルシステム上でより浅い階層にあるパスを優先して採用する。", "実行用ラッパーには、依存するPythonモジュールや外部ツール（LibreOffice, Node.js等）の有無を確認する `--self-check` オプションを実装する。", "外部プロセスの実行にはタイムアウト制約（デフォルト300秒、許容範囲5〜1800秒）を適用する。"], "anti_patterns": ["`.system/` で始まるディレクトリを公開スキルとして登録・露出させること。", "依存する外部バイナリ（soffice等）の存在を確認せずに、関連するコマンドを実行すること。"], "debt": ["xlsx用の `run.py` の実装が一部未完了（パッチが途切れている可能性あり）。", "Node.jsなどの外部ランタイム依存が「オプション」扱いとなっており、実行時の動的なエラーハンドリングに依存している。"], "scope": ["skills/portable-codex-skills/**", "dashboard/services/ai_skill_tools.py", "AIスキルのディスカバリおよび実行基盤"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "1a851313c35559b50f87a8635849c35dae9b4fbc", "timestamp": "2026-02-19T20:28:20+09:00", "summary": "エージェント知識ベース（AGENT_BRAIN）の更新と解決済みインシデントのアーカイブ処理", "intent": "過去の修正（ワークスペース管理、UI言語、不要ファイルの除外）を知識として定着させ、インシデント対応記録を整理・保存すること。", "new_rules": ["ワークスペースのピン留め管理には 'pinned-groups' という命名・ID体系を統一して使用する", "UIメッセージ（削除確認ダイアログ等）は日本語で実装する", "解決したインシデントは、メタデータやログを含めて reports/error_archive/resolved/ 配下にアーカイブする"], "anti_patterns": ["開発時の一時ファイル（tmp_*、workspace_*.js、ws.diff、*.bak等）をコミットに含めること", "ワークスペースのグループ管理に旧称の 'pinned-links' を使用すること"], "debt": ["スケジューラー関連コンポーネントの整理（一部テストで削除された要素の整合性確認）", "不要になったJS/CSSのクリーンアップ"], "scope": ["docs/", "skills/mfcloud-expense-receipt-reconcile/"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "675194f7dcfdebaaa3fdc6d298abdc164b1ffdf4", "timestamp": "2026-02-20T06:46:36+09:00", "summary": "ダッシュボードUIの日本語化方針の策定と、環境変数によるロケール切り替え機能の実装", "intent": "エンドユーザー向けUIの文言を日本語に統一し、保守性とユーザー体験を向上させつつ、環境変数による柔軟な言語切り替えを可能にする。", "new_rules": ["ダッシュボードUIのロケール既定値は 'ja' とする。", "ロケールの切り替えは環境変数 'DASHBOARD_UI_LOCALE' を使用する（例: ja, en）。", "UI文言（見出し、ボタン、説明、トースト、エラー表示）は原則として日本語に統一する。", "英語を許容するのは、コード識別子、APIキー、ログ解析用文字列など機械処理に必要な箇所のみとする。", "UI文言の追加・変更時は、HTMLの lang 属性および表示内容が日本語であることを確認する。"], "anti_patterns": ["UIの表示文言に、ロケール設定を無視して英語を直接ハードコードすること。", "PowerShell環境において、bash依存の環境変数設定構文（export等）をドキュメントや手順に含めること。"], "debt": ["本格的なi18nフレームワークの導入ではなく、環境変数と個別の翻訳ロジック（toFriendlyMessage等）に依存している。", "既存の全スキルに対してこの日本語化方針が完全に適用されているかの網羅的な確認。"], "scope": ["application", "other"], "confidence": 0.9, "risk": "low", "review_deadline": null, "source": "llm"}
{"commit": "889d0a803d2099d2ac0f4188d1df2932307c2eaa", "timestamp": "2026-02-20T08:36:38+09:00", "summary": "エラー修復プランの証拠分析改善と信頼性ガードレールの導入、およびハンドオフプロセスの形式化", "intent": "修復プランの信頼性を向上させ、実行フェーズ（Antigravity）への安全な移行を保証するために、検証コマンドの必須化と「handed_off」状態を導入する。", "new_rules": ["修復プランには必ず 'verification_commands' と 'done_criteria' を含めること。", "インシデントの状態遷移モデルに 'handed_off' を追加し、実行用パッケージは 'error_handoffs/' ディレクトリに集約する。", "プラン生成時に信頼性（confidence）のガードレールによるチェックを適用する。"], "anti_patterns": ["検証コマンドや完了定義が欠落した状態での修復プランの承認。", "正式なハンドオフパッケージ（handoff_json）を作成せずに実行フェーズへ移行すること。"], "debt": ["Antigravity実行エンジンとの物理的な連携部分の疎結合性の確保。", "信頼性スコアの閾値設定に関する具体的な運用基準の策定。"], "scope": ["skills/mfcloud-expense-receipt-reconcile/references/error_automation_contract.md", "skills/mfcloud-expense-receipt-reconcile/scripts/error_plan_generate.py", "skills/mfcloud-expense-receipt-reconcile/scripts/error_handoff_prepare.py"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "0e8b4605819f8341df27adf6c684820c0092b97e", "timestamp": "2026-02-20T08:49:21+09:00", "summary": "エラーハンドリングにおける「antigravity handoff flow」の導入とUIのローカライズ対応", "intent": "エラー発生時のインシデント管理を構造化し、外部または後続プロセスへの引き継ぎ（handoff）を円滑にするためのディレクトリ構成とUI要素を定義する。", "new_rules": ["エラーインシデント管理には、error_reports_root 配下の 'error_inbox/{incident_id}' および 'error_plans/{incident_id}/plan.json' のディレクトリ構造を厳守する。", "ダッシュボードのUI要素には、自動テストおよびスクリプト連携用として 'errors-handoff-queue' や 'errors-handoff-json' などの特定のIDを付与する。", "UIテキストは直接記述せず、ローカライズ（UI copy）の仕組みを通じて管理する。"], "anti_patterns": ["インシデント関連のファイルを所定のディレクトリ構造（inbox/plans）外に直接配置すること。", "PowerShell環境（start_dashboard.ps1）で動作しないbash固有の構文をスクリプトやコマンドライン引数に含めること。"], "debt": ["antigravity フローの具体的な外部連携仕様および、既存のエラーレポート機能との完全な互換性に関するドキュメント化。", "UIローカライズが適用されていない残存箇所の特定と修正。"], "scope": ["application", "other"], "confidence": 0.9, "risk": "medium", "review_deadline": null, "source": "llm"}
{"commit": "2a9c89646988677d398eab5d9389776fc918cd42", "timestamp": "2026-02-20T08:50:54+09:00", "summary": "ワークスペースAPIの実装、UIの統合、およびインシデント引き継ぎ（handoff）機能のテストカバレッジ向上", "intent": "ワークスペース管理機能を強化し、インシデント発生時の外部システム（antigravity等）への引き継ぎフローと状態管理を確実にする", "new_rules": ["ワークスペースのピン留め管理には 'pinned-groups' という命名・ID体系を統一して使用する", "UIメッセージ（削除確認ダイアログ等）は日本語で実装する", "解決したインシデントは、メタデータやログを含めて reports/error_archive/resolved/ 配下にアーカイブする", "インシデントの引き継ぎ状態は 'handed_off' ステータスと 'execution_owner' プロパティで管理する"], "anti_patterns": ["開発時の一時ファイル（tmp_*、workspace_*.js、ws.diff、*.bak等）をコミットに含めること", "ワークスペースのグループ管理に旧称の 'pinned-links' を使用すること"], "debt": ["スケジューラー関連コンポーネントの整理（一部テストで削除された要素の整合性確認）", "不要になったJS/CSSのクリーンアップ"], "scope": ["docs/", "skills/mfcloud-expense-receipt-reconcile/dashboard/", "skills/mfcloud-expense-receipt-reconcile/tests/"], "confidence": 1.0, "risk": "low", "review_deadline": null, "source": "llm"}
